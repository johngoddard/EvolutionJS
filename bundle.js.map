{"version":3,"sources":["webpack:///webpack/bootstrap d3e60bb962450040353b","webpack:///./lib/evolution.js","webpack:///./lib/simulation.js","webpack:///./lib/prey.js","webpack:///./lib/animal.js","webpack:///./lib/utils.js","webpack:///./lib/predator.js","webpack:///./lib/chart.js","webpack:///./lib/simulation_view.js"],"names":["window","addEventListener","canvas","document","getElementById","context","getContext","simulation","simulationView","Highcharts","setOptions","global","useUTC","MUTANT_COLORS","Simulation","dimX","dimY","initialPred","initialPrey","initialPredators","DIM_X","DIM_Y","reset","mutationRate","preyGeneration","predatorSpeed","predGeneration","rate","time","speed","predators","prey","steps","mutantIdx","generation","data","length","addPrey","addPredator","charter","color","strain","push","pos","randomPosition","radius","ctx","clearRect","allAnimals","forEach","animal","draw","moveAnimals","handleCollisions","reproducePrey","reproducePredators","die","recordData","strainInfo","getStrainInfo","avgSpeed","getAverageSpeed","dominantStrain","numStrains","strains","averageSpeed","strainCount","preyObj","population","totalSpeed","maxCount","maxStrain","Object","keys","total","reproduces","mutationNum","Math","random","resetReproduce","newSpeed","strainName","sinceReproduce","reproChance","reproLikelihood","predObj","sinceFood","remove","move","x","y","toRemove","isTouching","includes","resetSinceFood","item","type","idx","indexOf","splice","UTIL","Prey","options","velocity","closestPred","findClosestPredator","dir","findDirection","position","closest","minDistance","distance","predator","Animal","FULL","PI","otherAnimal","setVelocity","isOutOfBounds","wrap","fillStyle","beginPath","arc","fill","SIM_WIDTH","diff","pos1","pos2","abs","xDiff","yDiff","sqrt","pow","posDiff","xDir","yDir","magnitude","Predator","findClosestPrey","Charter","maxPopGen","maxFitGen","renderFitnessChart","renderPopulationChart","playing","popInterval","fitInterval","clearInterval","$","highcharts","chart","animation","svg","marginRight","style","fontFamily","events","load","preySeries","series","predSeries","setInterval","latest","maxGen","addPoint","title","text","fontSize","xAxis","tickPixelInterval","yAxis","labels","format","plotLines","value","width","tooltip","formatter","name","toFixed","legend","enabled","floating","verticalAlign","exporting","credits","marker","fitSeries","SimulationView","status","simulationSpeed","graphID","simulationID","initializeButtons","initializeSliders","initializeModal","click","$start","togglePlay","on","e","floor","currentTarget","setMutationRate","generationTime","setPreyGeneration","setPredatorSpeed","simSpeed","setSimulationSpeed","modal","show","stopPropagation","hide","view","simInterval","step","checkOver","handleExtinction","species","prop","$div","class","$p","generations","fitnessChange","increased","$btnContainer","$btn","id","append","clearOverlay","stop","resetStrainTable","start","togglePlaying","$overlay","pause","updateStrainTable","val","topStrains","getTopStrains","empty","strainArray","map","assign","sort","s1","s2","slice"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d3e60bb962450040353b\n **/","import Simulation from './simulation.js';\nimport SimulationView from './simulation_view.js';\nimport Charter from './chart.js';\n\nwindow.addEventListener('DOMContentLoaded', function(){\n  let canvas = document.getElementById('simulation-canvas');\n  let context = canvas.getContext('2d');\n  let simulation = new Simulation(500, 500, 5, 30);\n  let simulationView = new SimulationView(simulation, context);\n\n  Highcharts.setOptions({\n      global: {\n          useUTC: false\n      }\n  });\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/evolution.js\n **/","import Prey from './prey.js';\nimport Predator from './predator.js';\nimport Charter from './chart.js';\n\nconst MUTANT_COLORS = [\n  '#FFEE93',\n  '#99FF99',\n  '#ffef82',\n  '#3978c1',\n  '#5C5346',\n  '#A64253',\n  '#fbcc76'];\n\nclass Simulation {\n  constructor(dimX, dimY, initialPred, initialPrey) {\n    this.initialPredators = initialPred;\n    this.initialPrey = initialPrey;\n    this.DIM_X = dimX;\n    this.DIM_Y = dimY;\n    this.reset();\n    this.mutationRate = .04;\n    this.preyGeneration = 200;\n    this.predatorSpeed = 2.7;\n    this.predGeneration = 350;\n\n    this.reset();\n  }\n\n  setMutationRate(rate){\n    this.mutationRate = rate;\n  }\n\n  setPreyGeneration(time){\n    this.preyGeneration = time;\n  }\n\n  setPredatorSpeed(speed){\n    this.predatorSpeed = speed;\n  }\n\n  reset(){\n    this.predators = [];\n    this.prey = [];\n    this.steps = 0;\n    this.mutantIdx = 0;\n    this.generation = -1;\n    this.data = null;\n\n    while(this.prey.length < this.initialPrey){\n      this.addPrey(2, '#50BDD8', 'Original');\n    }\n\n    while(this.predators.length < this.initialPredators){\n      this.addPredator();\n    }\n\n    this.charter = new Charter(this);\n  }\n\n  addPrey(speed, color, strain){\n    if(this.prey.length < 100){\n      this.prey.push(new Prey({\n        pos: this.randomPosition(),\n        speed: speed,\n        radius: 5,\n        color: color,\n        simulation: this,\n        strain: strain\n      }));\n    }\n  }\n\n  addPredator(){\n\n    this.predators.push(new Predator({\n      pos: this.randomPosition(),\n      speed: this.predatorSpeed,\n      radius: 10,\n      color: '#F25F5C',\n      simulation: this,\n      mutationRate: .03\n    }));\n  }\n\n  allAnimals(){\n    return [...this.prey, ...this.predators];\n  }\n\n  draw(ctx){\n    ctx.clearRect(0, 0, this.DIM_X, this.DIM_Y);\n    this.allAnimals().forEach(animal => {\n      animal.draw(ctx);\n    });\n\n  }\n\n  step(){\n    this.moveAnimals();\n    this.handleCollisions();\n    this.reproducePrey();\n    this.reproducePredators();\n    this.die();\n    if(this.steps % (this.preyGeneration + 50) === 0){\n      this.generation++;\n      this.recordData(this.generation);\n    }\n\n    this.steps++;\n  }\n\n  recordData(generation){\n    let strainInfo = this.getStrainInfo();\n    let avgSpeed = this.getAverageSpeed();\n\n    this.data = {\n      generation: generation,\n      predators: (this.predators.length/this.initialPredators)*100,\n      prey: (this.prey.length/this.initialPrey)*100,\n      dominantStrain: strainInfo[1],\n      numStrains: strainInfo[0],\n      strains: strainInfo[2],\n      averageSpeed: avgSpeed\n    };\n\n  }\n\n  getStrainInfo(){\n    let strains = {};\n    let strainCount = 0;\n\n    this.prey.forEach(preyObj => {\n      if(strains[preyObj.strain]){\n        strains[preyObj.strain].population += 1;\n        strains[preyObj.strain].totalSpeed += preyObj.speed;\n      } else {\n        strains[preyObj.strain] = {\n          population: 1,\n          totalSpeed: preyObj.speed,\n          color: preyObj.color\n        };\n        strainCount += 1;\n      }\n    });\n\n    let maxCount = 0;\n    let maxStrain = null;\n\n    Object.keys(strains).forEach(strain => {\n      if(strains[strain].population > maxCount){\n        maxStrain = strain;\n        maxCount = strains[strain].population;\n      }\n    });\n\n    return [strainCount, maxStrain, strains];\n  }\n\n\n  getAverageSpeed(){\n    let total = 0;\n    this.prey.forEach(preyObj => {\n      total += preyObj.speed;\n    });\n    return (total / this.prey.length);\n  }\n\n  reproducePrey(){\n    const simulation = this;\n\n    this.prey.forEach(preyObj => {\n      if(simulation.reproduces(preyObj)){\n\n        const mutationNum = Math.random();\n        preyObj.resetReproduce();\n\n        if(mutationNum > (1 - (simulation.mutationRate / 2))){\n          this.mutantIdx += 1;\n          let newSpeed = preyObj.speed + .25;\n          let strainName = `Mutant-${this.mutantIdx}`;\n          this.addPrey(newSpeed, MUTANT_COLORS[this.mutantIdx % MUTANT_COLORS.length], strainName);\n        } else if (mutationNum < (simulation.mutationRate / 2)) {\n          this.mutantIdx += 1;\n          let newSpeed = preyObj.speed - .25;\n          let strainName = `Mutant-${this.mutantIdx}`;\n          this.addPrey(newSpeed, MUTANT_COLORS[this.mutantIdx % MUTANT_COLORS.length, strainName]);\n        } else {\n          let newSpeed = preyObj.speed + .1 * (.5 - Math.random());\n          this.addPrey(newSpeed, preyObj.color, preyObj.strain);\n        }\n      }\n    });\n\n  }\n\n  reproduces(prey){\n    if (prey.sinceReproduce > this.preyGeneration){\n      let reproChance = Math.random();\n      return (reproChance < (prey.sinceReproduce - this.preyGeneration) / 100) ? true : false;\n    } else {\n      return false;\n    }\n  }\n\n  reproducePredators(){\n    const simulation = this;\n\n    this.predators.forEach(predObj => {\n      const reproChance = Math.random();\n      const reproLikelihood = (predObj.sinceReproduce - this.predGeneration) / 100;\n\n      if(reproLikelihood > reproChance){\n        predObj.resetReproduce();\n        this.addPredator();\n      }\n    });\n  }\n\n  die(){\n    let simulation = this;\n\n    this.predators.forEach(predObj => {\n      if(predObj.sinceFood > 200 || predObj.steps > 1500){\n        simulation.remove(predObj, 'predator');\n      }\n    });\n\n    this.prey.forEach(preyObj => {\n      if(preyObj.steps > 600 || !preyObj.strain){\n        simulation.remove(preyObj, 'prey');\n      }\n    });\n  }\n\n  moveAnimals(){\n    this.allAnimals().forEach(animal => {\n      animal.move();\n    });\n  }\n\n  randomPosition() {\n    return [this.DIM_X * Math.random(), this.DIM_Y * Math.random()];\n  }\n\n  isOutOfBounds(pos){\n    if(pos[0] > this.DIM_X || pos[0] < this.DIM_X || pos[1] > this.DIM_Y || pos[1] < this.DIM_Y){\n      return true;\n    }\n    return false;\n  }\n\n  wrap(pos){\n    const x = (pos[0] + this.DIM_X) % this.DIM_X;\n    const y = (pos[1] + this.DIM_Y) % this.DIM_Y;\n    return [x,y];\n  }\n\n  handleCollisions(){\n    let toRemove = [];\n\n    let simulation = this;\n    this.prey.forEach(preyObj => {\n      simulation.predators.forEach(predObj =>{\n        if(preyObj.isTouching(predObj) && !toRemove.includes(preyObj)){\n          predObj.resetSinceFood();\n          toRemove.push(preyObj);\n        }\n      });\n    });\n\n    toRemove.forEach(item => {\n      this.remove(item, 'prey');\n    });\n  }\n\n  remove(animal, type){\n    if(type === 'prey'){\n      let idx = this.prey.indexOf(animal);\n      this.prey.splice(idx, 1);\n    } else {\n      let idx = this.predators.indexOf(animal);\n      this.predators.splice(idx, 1);\n    }\n  };\n}\n\nexport default Simulation;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/simulation.js\n **/","import Animal from './animal.js';\nimport * as UTIL from './utils.js';\n\nclass Prey extends Animal {\n  constructor(options){\n    super(options);\n  }\n\n\n  setVelocity(){\n    if(this.steps % 15 === 0 || (this.velocity[0] === 0 && this.velocity[1] === 0)){\n      let closestPred = this.findClosestPredator();\n      let dir = UTIL.findDirection(this.position, closestPred.position);\n      this.velocity = [- this.speed * dir[0], - this.speed * dir[1]];\n    }\n  }\n\n  findClosestPredator(){\n    let prey = this;\n\n    let closest;\n    let minDistance = 100000;\n\n    this.simulation.predators.forEach(predator => {\n      const distance = UTIL.distance(prey.position, predator.position);\n      if(distance < minDistance){\n        minDistance = distance;\n        closest = predator;\n      }\n    });\n\n    return closest;\n  }\n}\n\nexport default Prey;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/prey.js\n **/","import * as UTIL from './utils.js';\n\nclass Animal {\n  constructor(options) {\n    this.position = options['pos'];\n    this.speed = options['speed'];\n    this.radius = options['radius'];\n    this.color = options['color'];\n    this.simulation = options['simulation'];\n    this.velocity = [0, 0];\n    this.steps = 0;\n    this.strain = options['strain'];\n    this.sinceReproduce = 0;\n    this.FULL = 2*Math.PI;\n  }\n\n  isTouching(otherAnimal){\n    if(UTIL.distance(this.position, otherAnimal.position) < (this.radius + otherAnimal.radius)){\n      return true;\n    }\n    return false;\n  }\n\n  move(){\n    this.steps++;\n    this.setVelocity();\n\n    this.position[0] += this.velocity[0];\n    this.position[1] += this.velocity[1];\n\n    if(this.simulation.isOutOfBounds(this.position)){\n      this.position = this.simulation.wrap(this.position);\n    }\n\n    this.sinceReproduce++;\n  }\n\n\n  resetReproduce(){\n    this.sinceReproduce = 0;\n  }\n\n  draw(ctx){\n    ctx.fillStyle = this.color;\n    ctx.beginPath();\n\n    ctx.arc(\n      this.position[0],\n      this.position[1],\n      this.radius,\n      0,\n      this.FULL,\n      false\n    );\n\n    ctx.fill();\n  }\n}\n\nexport default Animal;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/animal.js\n **/","const SIM_WIDTH = 500;\n\nexport const diff = (pos1, pos2, dir) => {\n\n  let idx = dir === 'x' ? 0 : 1;\n\n  if(Math.abs(pos2[idx] - pos1[idx]) > (SIM_WIDTH / 2)){\n    if(pos2[idx] > (SIM_WIDTH / 2)){\n      return (pos2[idx] - SIM_WIDTH) - pos1[idx];\n    } else {\n      return (SIM_WIDTH + pos2[idx]) - pos1[idx];\n    }\n  } else {\n    return (pos2[idx] - pos1[idx]);\n  }\n};\n\n\nexport const dir = (pos1, pos2, dir) => {\n  let idx = dir === 'x' ? 0 : 1;\n  if(pos1[idx] < pos2[idx]){\n    if((pos2[idx] - pos1[idx]) < (pos1[idx] + SIM_WIDTH - pos2[idx])){\n      return 1;\n    } else {\n      return - 1;\n    }\n  } else {\n    if((pos1[idx] - pos2[idx]) < (pos2[idx] + SIM_WIDTH - pos1[idx])){\n      return -1;\n    } else {\n      return 1;\n    }\n  }\n};\n\n\nexport const distance = (pos1, pos2) => {\n  let xDiff = diff(pos1, pos2, 'x');\n  let yDiff = diff(pos1, pos2, 'y');\n\n  return Math.sqrt(Math.pow(xDiff, 2) + Math.pow(yDiff, 2));\n}\n\nexport const findDirection = (pos1, pos2) => {\n  let posDiff = [diff(pos1, pos2, 'x'), diff(pos1, pos2, 'y')];\n\n  let xDir = dir(pos1, pos2, 'x');\n  let yDir = dir(pos1, pos2, 'y');\n\n  let magnitude = Math.pow(posDiff[0], 2) + Math.pow(posDiff[1], 2);\n  return [xDir * Math.pow(posDiff[0], 2)/magnitude, yDir * Math.pow(posDiff[1], 2)/magnitude];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/utils.js\n **/","import Animal from './animal.js';\nimport * as UTIL from './utils.js';\n\n\nclass Predator extends Animal {\n  constructor(options){\n    super(options);\n    this.sinceFood = 0;\n  }\n\n  setVelocity(){\n    if(this.steps % 5 === 0 || (this.velocity[0] === 0 && this.velocity[1] === 0)){\n      let closestPred = this.findClosestPrey();\n      let dir = UTIL.findDirection(this.position, closestPred.position);\n\n      this.velocity = [\n        this.simulation.predatorSpeed * dir[0],\n        this.simulation.predatorSpeed * dir[1]\n      ];\n    }\n\n    this.sinceFood++;\n  }\n\n  findClosestPrey(){\n    let predator = this;\n\n    let closest;\n    let minDistance = 100000;\n\n    this.simulation.prey.forEach(prey => {\n      const distance = UTIL.distance(predator.position, prey.position);\n      if(distance < minDistance){\n        minDistance = distance;\n        closest = prey;\n      }\n    });\n\n    return closest;\n  }\n\n  resetSinceFood(){\n    this.sinceFood = 0;\n  }\n}\n\nexport default Predator;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/predator.js\n **/","class Charter {\n  constructor(simulation){\n    this.simulation = simulation;\n    this.maxPopGen = 0;\n    this.maxFitGen = 0;\n    this.renderFitnessChart();\n    this.renderPopulationChart();\n    this.playing = false;\n    this.popInterval;\n    this.fitInterval;\n  }\n\n  togglePlaying(){\n    this.playing = this.playing ? false : true;\n  }\n\n  stop(){\n    clearInterval(this.popInterval);\n    clearInterval(this.fitInterval);\n  }\n\n  renderPopulationChart(){\n    let simulation = this.simulation;\n    let charter = this;\n\n    $('#pop-graph').highcharts({\n      chart: {\n        type: 'spline',\n        animation: Highcharts.svg,\n        marginRight: 10,\n        style: {\n           fontFamily: \"'Roboto', sans-serif\"\n        },\n        events: {\n          load: function () {\n            let preySeries = this.series[0];\n            let predSeries = this.series[1];\n\n            charter.popInterval = setInterval(function () {\n              let latest = simulation.data;\n\n              if(latest && charter.playing && latest.generation > charter.maxPopGen){\n                charter.maxGen = latest.generation;\n\n                preySeries.addPoint([latest.generation, latest.prey], true, false);\n                predSeries.addPoint([latest.generation, latest.predators], true, false);\n              }\n            }, 1000);\n          }\n        }\n      },\n    title: {\n      text: 'Species Populations',\n      style: {\n              fontSize: '14px'\n            }\n    },\n    xAxis: {\n      title: {\n        text: 'Generations'\n      },\n      tickPixelInterval: 150\n    },\n    yAxis: {\n      title: {\n        text: 'Population (relative to initial)'\n      },\n      labels: {\n        format: `{value} %`\n      },\n      plotLines: [{\n        value: 0,\n        width: 1,\n        color: '#808080'\n      }]\n    },\n    tooltip: {\n      formatter: function () {\n        return '<b>' + `${this.series.name} Population` + '</b><br/>' +\n          `Generation: ${this.x}` + '<br/>' +\n          `Relative population: ${this.y.toFixed(2)} %`;\n      }\n    },\n    legend: {\n      enabled: true,\n      floating: true,\n      verticalAlign: 'top',\n      x: 0,\n      y: 9\n    },\n    exporting: {\n      enabled: false\n    },\n    credits: {\n      enabled: false\n    },\n    series: [{\n      name: 'Prey',\n      data: (function () {\n              return [[0,100]];\n            }()),\n      color: '#50BDD8',\n      marker: {\n        enabled: true\n        },\n      },\n      {\n        name: 'Predators',\n        data: (function () {\n          return [[0,100]];\n        }()),\n        color: '#F25F5C',\n        marker: {\n          enabled: true\n          },\n        }]\n    });\n  }\n\n  renderFitnessChart(){\n    let simulation = this.simulation;\n    let charter = this;\n    $('#fit-graph').highcharts({\n      chart: {\n        type: 'spline',\n        style: {\n           fontFamily: \"'Roboto', sans-serif\"\n        },\n        animation: Highcharts.svg,\n        marginRight: 10,\n        events: {\n          load: function () {\n            let fitSeries = this.series[0];\n\n            charter.fitInterval = setInterval(function () {\n              let latest = simulation.data;\n\n              if(latest && charter.playing && latest.generation > charter.maxFitGen){\n                charter.maxFitGen = latest.generation;\n                fitSeries.addPoint([latest.generation, latest.averageSpeed], true, false);\n              }\n            }, 1000);\n          }\n        }\n      },\n    title: {\n      text: 'Average Prey Fitness',\n      style: {\n              fontSize: '14px'\n            }\n    },\n    xAxis: {\n      title: {\n        text: 'Generations'\n      },\n      tickPixelInterval: 150\n    },\n    yAxis: {\n      title: {\n        text: 'Average Speed'\n      },\n      labels: {\n        format: `{value}`\n      },\n      plotLines: [{\n        value: 0,\n        width: 1,\n        color: '#f00'\n      }]\n    },\n    tooltip: {\n      formatter: function () {\n        return '<b>' + `Average Prey Fitness` + '</b><br/>' +\n          `Generation: ${this.x}` + '<br/>' +\n          `Average speed: ${this.y.toFixed(2)}`;\n      }\n    },\n    legend: {\n      enabled: false,\n    },\n    exporting: {\n      enabled: false\n    },\n    credits: {\n      enabled: false\n    },\n    series: [{\n      name: 'Average Speed',\n      color: '#71b871',\n      data: (function () {\n              return [[0,2]];\n            }())\n      }]\n    });\n  }\n}\n\nexport default Charter;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/chart.js\n **/","class SimulationView {\n  constructor(simulation, ctx) {\n    this.simulation = simulation;\n    this.ctx = ctx;\n    this.maxGen = 0;\n    this.status = 'paused';\n    this.simulationSpeed = 1;\n    this.graphID;\n    this.simulationID;\n\n    this.initializeButtons();\n    this.initializeSliders();\n    this.initializeModal();\n  }\n\n  initializeButtons(){\n    $('#play-btn').click(() => {\n      let $start = $('#start-overlay');\n      if($start){\n        $start.remove();\n      }\n      this.togglePlay();\n    });\n\n    $('#reset-btn').click(() => {\n      this.reset();\n    });\n\n    $('#overlay-start').click(() => {\n      $('#start-overlay').remove();\n      this.togglePlay();\n    });\n  }\n\n  initializeSliders(){\n    $('#mut-slider').on('input', (e) => {\n      $('#mut-val').text(`${Math.floor(e.currentTarget.value * 100)}%`);\n    });\n\n    $('#mut-slider').on('change', (e) => {\n      let mutationRate = e.currentTarget.value;\n      this.simulation.setMutationRate(mutationRate);\n    });\n\n    $('#gen-slider').on('input', (e) => {\n      $('#gen-val').text(`${e.currentTarget.value}`);\n    });\n\n    $('#gen-slider').on('change', (e) => {\n      let generationTime = e.currentTarget.value;\n      this.simulation.setPreyGeneration(generationTime * 50);\n    });\n\n    $('#speed-slider').on('input', (e) => {\n      $('#speed-val').text(`${e.currentTarget.value}`);\n    });\n\n    $('#speed-slider').on('change', (e) => {\n      let speed = e.currentTarget.value;\n      this.simulation.setPredatorSpeed(speed);\n    });\n\n    $('#sim-speed-slider').on('input', (e) => {\n      $('#sim-val').text(`${e.currentTarget.value}x`);\n    });\n\n    $('#sim-speed-slider').on('change', (e) => {\n      let simSpeed = e.currentTarget.value;\n      this.setSimulationSpeed(simSpeed);\n    });\n  }\n\n  initializeModal(){\n    let modal = $('.about-modal-overlay');\n\n    $('.modal-link').click((e) => {\n      modal.show();\n      e.stopPropagation();\n    });\n\n    $('.about-modal').click((e) => {\n      e.stopPropagation();\n    });\n\n    $(window).click(() => {\n      modal.hide();\n    });\n\n    $('#close-modal-btn').click((e) => {\n      modal.hide();\n      e.stopPropagation();\n    });\n\n  }\n\n  setSimulationSpeed(speed){\n    this.simulationSpeed = speed;\n\n    let view = this;\n\n    if(this.simulationID){\n      clearInterval(this.simulationID);\n    }\n\n    if(this.status === 'playing'){\n      let simInterval = 30 / speed;\n      this.simulationID = window.setInterval(() => {\n        view.simulation.draw(view.ctx);\n        view.simulation.step();\n        view.checkOver();\n      }, simInterval);\n    }\n  }\n\n  checkOver(){\n    if(this.simulation.prey.length === 0){\n      window.clearInterval(this.simulationID);\n      this.simulation.draw(this.ctx);\n      this.handleExtinction('prey');\n    } else if(this.simulation.predators.length === 0){\n      window.clearInterval(this.simulationID);\n      this.simulation.draw(this.ctx);\n      this.handleExtinction('predators')\n    }\n  }\n\n  handleExtinction(species){\n    $('#play-btn').prop('disabled', true);\n    let $div = $('<div>', {class: 'extinction-overlay after-sim'});\n    let $p = $('<p>', {class: 'ex-text'});\n\n    const generations = this.maxGen === 1 ? 'generation' : 'generations';\n    const fitnessChange = (100*((this.simulation.data.averageSpeed - 2)/2)).toFixed(1);\n    const increased  = fitnessChange >= 0 ? 'increased' : 'decreased';\n\n    $p.text(`The ${species} have gone extinct after ${this.maxGen} ${generations}! The prey fitness ${increased} by ${fitnessChange}%.`);\n\n    let $btnContainer = $('<div>', {class: \"overlay-btn-cont\"});\n    let $btn = $('<button>', {class: 'btn btn-success', id: 'overlay-reset', type: 'button'});\n    $btn.text('Restart');\n    $btn.click(() => this.reset());\n    $btnContainer.append($btn);\n\n    $div.append($p);\n    $div.append($btnContainer);\n\n    $('#sim-container').append($div);\n  }\n\n  reset(){\n    clearInterval(this.graphID);\n    clearInterval(this.simulationID);\n\n    $('#play-btn').prop('disabled', false);\n    this.clearOverlay();\n\n    this.maxGen = 0;\n    this.simulation.charter.stop();\n    this.simulation.reset();\n    this.resetStrainTable();\n\n    if(this.status === 'paused'){\n      this.togglePlay();\n    } else{\n      this.start();\n      this.simulation.charter.togglePlaying();\n    }\n  }\n\n  clearOverlay(){\n    let $overlay = $('.extinction-overlay');\n    if ($overlay.length > 0) {\n      $overlay[0].remove();\n    }\n  }\n\n\n\n  togglePlay(){\n    if(this.status === 'paused'){\n      this.status = 'playing';\n      this.start();\n      $('#play-btn').text('Pause');\n    } else{\n      this.pause();\n      this.status = 'paused';\n      $('#play-btn').text('Play');\n    }\n\n    this.simulation.charter.togglePlaying();\n  }\n\n  pause(){\n    clearInterval(this.graphID);\n    clearInterval(this.simulationID);\n  }\n\n  start(){\n    let view = this;\n\n    this.graphID = setInterval(function () {\n      let latest = view.simulation.data;\n\n      if(latest.generation > view.maxGen){\n        view.maxGen = latest.generation;\n        view.updateStrainTable();\n      }\n    }, 1000);\n\n    this.setSimulationSpeed($('#sim-speed-slider').val());\n  }\n\n  updateStrainTable(){\n\n    const topStrains = this.getTopStrains();\n    $('#top-strains-body').empty();\n\n    topStrains.forEach(strain => {\n      $('#top-strains-body').append(\n        `<tr>\n          <td>\n            <div class=\"strain-key\" style=\"background:${strain.color}\"></div>\n            ${strain.name}\n          </td>\n          <td>${strain.population}</td>\n          <td>${(strain.totalSpeed / strain.population).toFixed(2)}</td>\n        </tr>`\n      );\n    });\n\n    $('#table-title').text(`Top Strains: Generation ${this.maxGen}`);\n  }\n\n  getTopStrains(){\n    const strains = this.simulation.data.strains;\n\n    let strainArray = Object.keys(strains).map(strainName =>{\n      return Object.assign({}, strains[strainName], {name: strainName});\n    });\n\n    return strainArray.sort((s1, s2) => {\n      return s2.population - s1.population;\n    }).slice(0,3);\n  }\n\n  resetStrainTable(){\n    $('#top-strains-body').empty();\n    $('#top-strains-body').append(\n      `<tr>\n        <td>\n          <div class=\"strain-key\" style=\"background:blue\"></div>\n          Original\n        </td>\n        <td>30</td>\n        <td>2</td>\n      </tr>`\n    );\n\n    $('#table-title').text('Top strains: Generation 0');\n  }\n}\n\nexport default SimulationView;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/simulation_view.js\n **/"],"sourceRoot":""}